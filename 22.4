CREATE TABLE STATS (
                        STAT_ID INT(11) AUTO_INCREMENT PRIMARY KEY,
                        STAT_DATE DATETIME NOT NULL,
                        STAT VARCHAR(20) NOT NULL,
                        VALUE INT(11) NOT NULL
                );
                
                
                
CREATE VIEW BESTSELLERS_COUNT AS
    SELECT SUM(BESTSELLER) FROM books
WHERE BESTSELLER > 0;



USE kodilla_course;
CREATE EVENT UPDATE_BESTSELLER
ON SCHEDULE EVERY 1 MINUTE
DO
BEGIN
    CALL UpdateBestsellers();
    INSERT INTO stats (STAT_DATE, STAT, VALUE) SELECT CURTIME(), 'BESTSELLERS', `SUM(BESTSELLER)`
        FROM bestsellers_count

END;
    END
